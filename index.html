<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>·ª®ng d·ª•ng hi·ªÉn th·ªã ng·∫´u nhi√™n</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, Helvetica, sans-serif;
      background: linear-gradient(135deg,#e3f2fd,#bbdefb);
      height: 100vh;
      overflow: hidden;
    }

    .toolbar {
      position: fixed;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      background: rgba(255,255,255,0.9);
      padding: 10px 20px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
      align-items: center;
    }

    input {
      padding: 6px 8px;
      border-radius: 6px;
      border: 1px solid #90caf9;
    }

    button {
      padding: 6px 12px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      color: white;
    }

    #btnAdd { background-color: #0078D4; }
    #btnShow { background-color: #4CAF50; }
    #btnClear { background-color: #f44336; }

    .hello {
      position: fixed;
      font-weight: bold;
      color: #1976d2;
      border: 2px solid #1976d2;
      border-radius: 8px;
      background: rgba(255,255,255,0.8);
      padding: 6px 10px;
      animation: fadeIn 0.3s ease-in;
    }

    @keyframes fadeIn {
      from { transform: scale(0.5); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
  </style>
</head>
<body>
  <div class="toolbar">
    <input id="messageInput" type="text" placeholder="Nh·∫≠p g√¨ ƒë√≥..." />
    <button id="btnAdd">Th√™m</button>
    <button id="btnShow">Hi·ªÉn th·ªã ng·∫´u nhi√™n</button>
    <button id="btnClear">X√≥a t·∫•t c·∫£</button>
  </div>

  <script>
    const input = document.getElementById('messageInput');
    const btnAdd = document.getElementById('btnAdd');
    const btnShow = document.getElementById('btnShow');
    const btnClear = document.getElementById('btnClear');

    // ‚ûï G·ª≠i d·ªØ li·ªáu l√™n server (API /api/add)
    btnAdd.onclick = async () => {
      const msg = input.value.trim();
      if (msg === "") {
        alert("Vui l√≤ng nh·∫≠p n·ªôi dung!");
        return;
      }

      try {
        const res = await fetch("/api/add", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message: msg })
        });
        const data = await res.json();
        if (data.success) alert("ƒê√£ th√™m v√†o c∆° s·ªü d·ªØ li·ªáu!");
        else alert("L·ªói th√™m d·ªØ li·ªáu!");
        input.value = "";
      } catch (err) {
        console.error(err);
        alert("Kh√¥ng th·ªÉ k·∫øt n·ªëi server!");
      }
    };

    // üé≤ L·∫•y ng·∫´u nhi√™n 1 d√≤ng t·ª´ server (API /api/random)
    btnShow.onclick = async () => {
      try {
        const res = await fetch("/api/random");
        const data = await res.json();
        if (!res.ok) {
          alert(data.error || "Kh√¥ng c√≥ d·ªØ li·ªáu!");
          return;
        }

        const el = document.createElement("div");
        el.className = "hello";
        el.textContent = data.message;

        const vw = window.innerWidth;
        const vh = window.innerHeight;

        el.style.left = Math.random() * (vw - 120) + "px";
        el.style.top = Math.random() * (vh - 60) + "px";

        document.body.appendChild(el);
      } catch (err) {
        alert("Kh√¥ng th·ªÉ k·∫øt n·ªëi server!");
      }
    };

    // ‚ùå X√≥a to√†n b·ªô (API /api/clear)
    btnClear.onclick = async () => {
      if (!confirm("B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a t·∫•t c·∫£ d·ªØ li·ªáu?")) return;
      try {
        const res = await fetch("/api/clear", { method: "DELETE" });
        const data = await res.json();
        if (data.success) {
          document.querySelectorAll(".hello").forEach(e => e.remove());
          alert("üóëÔ∏è ƒê√£ x√≥a t·∫•t c·∫£ d·ªØ li·ªáu!");
        } else {
          alert("L·ªói x√≥a d·ªØ li·ªáu!");
        }
      } catch (err) {
        alert("Kh√¥ng th·ªÉ k·∫øt n·ªëi server!");
      }
    };
  </script>

</body>
</html>
